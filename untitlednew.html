<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKtreading - Elite Edition</title>
    <style>
        :root { --primary: #800040; --accent: #d81b60; --whatsapp: #25D366; --bg: #f4f7f6; --dark: #1a1a1a; --success: #28a745; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); color: #333; }
        .hidden { display: none !important; }
        .card { background: white; padding: 25px; border-radius: 25px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 85%; max-width: 400px; margin: 20px auto; text-align: center; }
        .btn-main { background: var(--accent); color: white; border: none; padding: 15px; width: 100%; border-radius: 15px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
        header { background: linear-gradient(180deg, var(--primary) 0%, #33001a 100%); color: white; padding: 25px 20px 60px; border-radius: 0 0 40px 40px; text-align: center; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: -40px 20px 20px; }
        .stat-box { background: white; padding: 15px; border-radius: 20px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .admin-box { background: white; border-radius: 20px; padding: 20px; margin: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        table { width: 100%; border-collapse: collapse; font-size: 11px; margin-top: 10px; }
        th, td { border: 1px solid #eee; padding: 8px; text-align: left; }
        .wa-float { position: fixed; bottom: 20px; right: 20px; background: var(--whatsapp); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; font-size: 30px; z-index: 1000; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
    </style>
</head>
<body onload="initSystem()">

    <a href="#" id="wa-link" class="wa-float" target="_blank">ðŸ’¬</a>

    <div id="auth-page">
        <div class="card">
            <h2 style="color:var(--primary);">PKtreading</h2>
            <input type="number" id="u-phone" placeholder="Phone Number">
            <input type="password" id="u-pass" placeholder="Password">
            <button class="btn-main" onclick="handleAuth()">Login / Register</button>
            <p onclick="adminLogin()" style="font-size:10px; color:#999; margin-top:20px; cursor:pointer;">Admin Login</p>
        </div>
    </div>

    <div id="plan-page" class="hidden">
        <h3 style="text-align:center; color:var(--primary); margin-top:20px;">Available Plans</h3>
        <div id="plan-list" style="padding:10px;"></div>
    </div>

    <div id="pay-page" class="hidden">
        <div class="card">
            <h3>Deposit</h3>
            <div style="background:#fff0f5; padding:15px; border-radius:15px; text-align:left; font-size:13px;">
                <b>EasyPaisa:</b> <span id="set-ep"></span><br><b>JazzCash:</b> <span id="set-jc"></span>
            </div>
            <input type="text" id="tid-input" placeholder="TID Number">
            <input type="file" id="ss-file" accept="image/*" onchange="handleSS(this)">
            <button class="btn-main" onclick="submitDeposit()">Submit Proof</button>
        </div>
    </div>

    <div id="dash-page" class="hidden">
        <header>
            <h2 id="d-name">User Dashboard</h2>
            <p id="d-phone" style="font-size:12px; opacity:0.8;"></p>
        </header>
        <div class="stat-grid">
            <div class="stat-box"><b>Rs <span id="d-bal">0</span></b><br><small>Balance</small></div>
            <div class="stat-box"><b><span id="d-days">0</span></b><br><small>Days Left</small></div>
        </div>
        
        <div class="card" style="margin-top:0;">
            <button class="btn-main" onclick="showPage('withdraw-page')">Withdraw Cash</button>
            <button class="btn-main" style="background:#555;" onclick="showPage('history-page')">Withdraw History</button>
            <button class="btn-main" style="background:#333;" onclick="logout()">Logout</button>
        </div>
    </div>

    <div id="withdraw-page" class="hidden">
        <div class="card">
            <h3>Withdraw Money</h3>
            <input type="number" id="w-amt" placeholder="Amount">
            <input type="text" id="w-method" placeholder="Method (EasyPaisa/JazzCash)">
            <input type="number" id="w-phone" placeholder="Account Number">
            <button class="btn-main" onclick="submitWithdraw()">Send Request</button>
            <button onclick="showDashboard()" style="background:none; border:none; color:#666; margin-top:10px; cursor:pointer;">Back</button>
        </div>
    </div>

    <div id="history-page" class="hidden">
        <div class="card" style="max-width:500px;">
            <h3>Withdraw History</h3>
            <div id="history-list"></div>
            <button class="btn-main" onclick="showDashboard()">Back to Home</button>
        </div>
    </div>

    <div id="admin-panel" class="hidden">
        <div style="background:var(--dark); color:white; padding:15px; display:flex; justify-content:space-between;">
            <b>ADMIN MASTER</b>
            <button onclick="location.reload()" style="color:white; background:none; border:1px solid white;">Exit</button>
        </div>
        <div class="admin-box">
            <h3>Pending Deposits</h3>
            <div id="admin-deposits"></div>
        </div>
        <div class="admin-box">
            <h3>Withdraw Requests</h3>
            <div id="admin-withdraws"></div>
        </div>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('pkt_mega_db')) || {
            users: {}, pending_dep: [], pending_wd: [],
            settings: {ep:"0301-2472206", jc:"0300-1234567", wa:"923012472206"}
        };
        let session = localStorage.getItem('pkt_user');
        let tempSS = "";

        function save() { localStorage.setItem('pkt_mega_db', JSON.stringify(db)); }

        function initSystem() {
            updateSystemUI();
            if(session && db.users[session]) {
                runAutoProfit();
                showDashboard();
            }
        }

        function handleAuth() {
            let p = document.getElementById('u-phone').value;
            let ps = document.getElementById('u-pass').value;
            if(!p || !ps) return alert("Fill all!");
            if(!db.users[p]) db.users[p] = { phone:p, pass:ps, bal:0, status:"No Plan", daily:0, daysLeft:0, lastProfit:Date.now(), history:[] };
            session = p;
            localStorage.setItem('pkt_user', p);
            save();
            db.users[p].status === "No Plan" ? renderPlans() : showDashboard();
        }

        function renderPlans() {
            showPage('plan-page');
            let list = document.getElementById('plan-list');
            list.innerHTML = [1000, 2000, 5000, 10000].map(amt => `
                <div class="card" style="text-align:left; padding:15px;">
                    <b>Rs ${amt} Plan</b><br><small>Daily Rs ${amt*0.1} (20 Days)</small>
                    <button class="btn-main" style="width:auto; float:right; margin-top:-25px;" onclick="goPay(${amt})">Buy</button>
                </div>`).join('');
        }

        function goPay(amt) {
            localStorage.setItem('temp_amt', amt);
            showPage('pay-page');
        }

        function handleSS(input) {
            let reader = new FileReader();
            reader.onload = e => tempSS = e.target.result;
            reader.readAsDataURL(input.files[0]);
        }

        function submitDeposit() {
            let tid = document.getElementById('tid-input').value;
            let amt = localStorage.getItem('temp_amt');
            db.pending_dep.push({ phone:session, tid:tid, ss:tempSS, amt:parseInt(amt) });
            db.users[session].status = "Pending";
            save(); alert("Submitted!"); showDashboard();
        }

        function submitWithdraw() {
            let amt = parseInt(document.getElementById('w-amt').value);
            let u = db.users[session];
            if(amt > u.bal || amt < 100) return alert("Incomplete details or low balance!");
            
            let req = { id:Date.now(), phone:session, amt:amt, method:document.getElementById('w-method').value, acc:document.getElementById('w-phone').value, status:"Pending" };
            db.pending_wd.push(req);
            u.history.push(req);
            save(); alert("Request Sent!"); showDashboard();
        }

        function runAutoProfit() {
            let u = db.users[session];
            if(u.status === "Active" && u.daysLeft > 0) {
                let now = Date.now();
                if(now - u.lastProfit >= 24*60*60*1000) {
                    u.bal += u.daily; u.daysLeft -= 1; u.lastProfit = now; save();
                }
            }
        }

        function showDashboard() {
            showPage('dash-page');
            let u = db.users[session];
            document.getElementById('d-phone').innerText = u.phone;
            document.getElementById('d-bal').innerText = u.bal;
            document.getElementById('d-days').innerText = u.daysLeft;
        }

        function renderHistory() {
            let list = document.getElementById('history-list');
            list.innerHTML = db.users[session].history.map(h => `
                <div style="border-bottom:1px solid #eee; padding:10px; font-size:12px; text-align:left;">
                    <b>Rs ${h.amt}</b> - ${h.method} (${h.acc}) <br>
                    <span style="color:${h.status==='Approved'?'green':'orange'}">Status: ${h.status}</span>
                </div>`).join('') || "No History";
        }

        function adminLogin() {
            if(prompt("Pass:") === "Waqar786") { showPage('admin-panel'); renderAdmin(); }
        }

        function renderAdmin() {
            document.getElementById('admin-deposits').innerHTML = db.pending_dep.map((d, i) => `
                <table><tr><td>${d.phone}</td><td>Rs ${d.amt}</td><td><button onclick="approveDep(${i})">Approve</button></td></tr></table>`).join('');
            document.getElementById('admin-withdraws').innerHTML = db.pending_wd.map((w, i) => `
                <table><tr><td>${w.phone}</td><td>Rs ${w.amt}</td><td><button onclick="approveWd(${i})">Pay Now</button></td></tr></table>`).join('');
        }

        function approveDep(i) {
            let d = db.pending_dep[i]; let u = db.users[d.phone];
            u.status = "Active"; u.daily = d.amt*0.1; u.bal += u.daily; u.daysLeft = 19; u.lastProfit = Date.now();
            db.pending_dep.splice(i, 1); save(); renderAdmin();
        }

        function approveWd(i) {
            let w = db.pending_wd[i]; let u = db.users[w.phone];
            u.bal -= w.amt; 
            let h = u.history.find(x => x.id === w.id); if(h) h.status = "Approved";
            db.pending_wd.splice(i, 1); save(); renderAdmin();
        }

        function showPage(id) {
            document.querySelectorAll('body > div').forEach(d => d.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            if(id === 'history-page') renderHistory();
        }

        function updateSystemUI() {
            document.getElementById('set-ep').innerText = db.settings.ep;
            document.getElementById('set-jc').innerText = db.settings.jc;
            document.getElementById('wa-link').href = "https://wa.me/" + db.settings.wa;
        }

        function logout() { localStorage.removeItem('pkt_user'); location.reload(); }
    </script>
</body>
</html>
